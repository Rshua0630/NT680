//This source code is generated by UI Designer Studio.

#include "UIFramework.h"
#include "UIFrameworkExt.h"
#include "NVTToolCommand.h"
#include "UIMenuWndWiFiWaitRes.c"
#include "UIFlow.h"

//---------------------UIMenuWndWiFiWaitCtrl Debug Definition -----------------------------
#define _UIMENUWNDWIFIWAIT_ERROR_MSG        1
#define _UIMENUWNDWIFIWAIT_TRACE_MSG        0

#if (_UIMENUWNDWIFIWAIT_ERROR_MSG&(PRJ_DBG_LVL>=PRJ_DBG_LVL_ERR))
#define UIMenuWndWiFiWaitErrMsg(...)            debug_msg ("^R UIMenuWndWiFiWait: "__VA_ARGS__)
#else
#define UIMenuWndWiFiWaitErrMsg(...)
#endif

#if (_UIMENUWNDWIFIWAIT_TRACE_MSG&(PRJ_DBG_LVL>=PRJ_DBG_LVL_TRC))
#define UIMenuWndWiFiWaitTraceMsg(...)          debug_msg ("^B UIMenuWndWiFiWait: "__VA_ARGS__)
#else
#define UIMenuWndWiFiWaitTraceMsg(...)
#endif

//---------------------UIMenuWndWiFiWaitCtrl Global Variables -----------------------------

//---------------------UIMenuWndWiFiWaitCtrl Prototype Declaration  -----------------------

//---------------------UIMenuWndWiFiWaitCtrl Public API  ----------------------------------

//---------------------UIMenuWndWiFiWaitCtrl Private API  ---------------------------------
//---------------------UIMenuWndWiFiWaitCtrl Control List---------------------------
CTRL_LIST_BEGIN(UIMenuWndWiFiWait)
CTRL_LIST_ITEM(UIMenuWndWiFiWait_StatusGraph)
CTRL_LIST_END

//----------------------UIMenuWndWiFiWaitCtrl Event---------------------------
INT32 UIMenuWndWiFiWait_OnOpen(VControl *, UINT32, UINT32 *);
INT32 UIMenuWndWiFiWait_OnClose(VControl *, UINT32, UINT32 *);
INT32 UIMenuWndWiFiWait_OnChildClose(VControl *, UINT32, UINT32 *);
INT32 UIMenuWndWiFiWait_OnKeyMenu(VControl *, UINT32, UINT32 *);
INT32 UIMenuWndWiFiWait_OnKeyUp(VControl *, UINT32, UINT32 *);
INT32 UIMenuWndWiFiWait_OnKeyDown(VControl *, UINT32, UINT32 *);
INT32 UIMenuWndWiFiWait_OnKeyEnter(VControl *, UINT32, UINT32 *);
INT32 UIMenuWndWiFiWait_OnKeyShutter2(VControl *, UINT32, UINT32 *);
INT32 UIMenuWndWiFiWait_OnKeyMode(VControl *, UINT32, UINT32 *);
INT32 UIMenuWndWiFiWait_OnBattery(VControl *, UINT32, UINT32 *);
INT32 UIMenuWndWiFiWait_OnTimer(VControl *, UINT32, UINT32 *);
INT32 UIMenuWndWiFiWait_OnBackgroundDone(VControl *, UINT32, UINT32 *);
EVENT_BEGIN(UIMenuWndWiFiWait)
EVENT_ITEM(NVTEVT_OPEN_WINDOW, UIMenuWndWiFiWait_OnOpen)
EVENT_ITEM(NVTEVT_CLOSE_WINDOW, UIMenuWndWiFiWait_OnClose)
EVENT_ITEM(NVTEVT_CHILD_CLOSE, UIMenuWndWiFiWait_OnChildClose)
EVENT_ITEM(NVTEVT_KEY_MENU, UIMenuWndWiFiWait_OnKeyMenu)
EVENT_ITEM(NVTEVT_KEY_UP, UIMenuWndWiFiWait_OnKeyUp)
EVENT_ITEM(NVTEVT_KEY_DOWN, UIMenuWndWiFiWait_OnKeyDown)
EVENT_ITEM(NVTEVT_KEY_ENTER, UIMenuWndWiFiWait_OnKeyEnter)
EVENT_ITEM(NVTEVT_KEY_SHUTTER2, UIMenuWndWiFiWait_OnKeyShutter2)
EVENT_ITEM(NVTEVT_KEY_MODE, UIMenuWndWiFiWait_OnKeyMode)
EVENT_ITEM(NVTEVT_BATTERY, UIMenuWndWiFiWait_OnBattery)
EVENT_ITEM(NVTEVT_TIMER, UIMenuWndWiFiWait_OnTimer)
EVENT_ITEM(NVTEVT_BACKGROUND_DONE, UIMenuWndWiFiWait_OnBackgroundDone)
EVENT_END

INT32 UIMenuWndWiFiWait_OnOpen(VControl *pCtrl, UINT32 paramNum, UINT32 *paramArray)
{
	Ux_DefaultEvent(pCtrl, NVTEVT_OPEN_WINDOW, paramNum, paramArray);
	return NVTEVT_CONSUME;
}
INT32 UIMenuWndWiFiWait_OnClose(VControl *pCtrl, UINT32 paramNum, UINT32 *paramArray)
{
	Ux_DefaultEvent(pCtrl, NVTEVT_CLOSE_WINDOW, paramNum, paramArray);
	return NVTEVT_CONSUME;
}
INT32 UIMenuWndWiFiWait_OnChildClose(VControl *pCtrl, UINT32 paramNum, UINT32 *paramArray)
{
	Ux_DefaultEvent(pCtrl, NVTEVT_CHILD_CLOSE, paramNum, paramArray);
	return NVTEVT_CONSUME;
}
INT32 UIMenuWndWiFiWait_OnKeyMenu(VControl *pCtrl, UINT32 paramNum, UINT32 *paramArray)
{
	Ux_DefaultEvent(pCtrl, NVTEVT_KEY_MENU, paramNum, paramArray);
	return NVTEVT_CONSUME;
}
INT32 UIMenuWndWiFiWait_OnKeyUp(VControl *pCtrl, UINT32 paramNum, UINT32 *paramArray)
{
	Ux_DefaultEvent(pCtrl, NVTEVT_KEY_UP, paramNum, paramArray);
	return NVTEVT_CONSUME;
}
INT32 UIMenuWndWiFiWait_OnKeyDown(VControl *pCtrl, UINT32 paramNum, UINT32 *paramArray)
{
	Ux_DefaultEvent(pCtrl, NVTEVT_KEY_DOWN, paramNum, paramArray);
	return NVTEVT_CONSUME;
}
INT32 UIMenuWndWiFiWait_OnKeyEnter(VControl *pCtrl, UINT32 paramNum, UINT32 *paramArray)
{
	Ux_DefaultEvent(pCtrl, NVTEVT_KEY_ENTER, paramNum, paramArray);
	return NVTEVT_CONSUME;
}
INT32 UIMenuWndWiFiWait_OnKeyShutter2(VControl *pCtrl, UINT32 paramNum, UINT32 *paramArray)
{
	Ux_DefaultEvent(pCtrl, NVTEVT_KEY_SHUTTER2, paramNum, paramArray);
	return NVTEVT_CONSUME;
}
INT32 UIMenuWndWiFiWait_OnKeyMode(VControl *pCtrl, UINT32 paramNum, UINT32 *paramArray)
{
	return NVTEVT_CONSUME;
}
INT32 UIMenuWndWiFiWait_OnBattery(VControl *pCtrl, UINT32 paramNum, UINT32 *paramArray)
{
	return NVTEVT_CONSUME;
}
INT32 UIMenuWndWiFiWait_OnTimer(VControl *pCtrl, UINT32 paramNum, UINT32 *paramArray)
{
	Ux_DefaultEvent(pCtrl, NVTEVT_TIMER, paramNum, paramArray);
	return NVTEVT_CONSUME;
}
extern BOOL bIsWiFiRecorded;

INT32 UIMenuWndWiFiWait_OnBackgroundDone(VControl *pCtrl, UINT32 paramNum, UINT32 *paramArray)
{
	NVTEVT event;
	//UINT32 status;

	event = paramArray[ONDONE_PARAM_INDEX_CMD];
	//status = paramArray[ONDONE_PARAM_INDEX_RET];
	//debug_msg("^G%s: NVTEVT_BKW_WIFI_ON = 0x%x\r\n", __func__, NVTEVT_BKW_WIFI_ON);
	//debug_msg("^G%s: event = 0x%x, status=%d\r\n", __func__, event, status);

	switch (event) {
	case NVTEVT_BKW_WIFI_ON:
		if (UI_GetData(FL_WIFI_LINK) == WIFI_LINK_OK) {
			//change to wifi mode,would close wait wnd
			//change to wifi mode would auto start record movie
			bIsWiFiRecorded =  FALSE;
#if (WIFI_FUNC==ENABLE)
		    if (System_GetState(SYS_STATE_CURRMODE) != PRIMARY_MODE_MOVIE){
			    Ux_PostEvent(NVTEVT_SYSTEM_MODE, 1, PRIMARY_MODE_MOVIE);
			}
			Ux_PostEvent(NVTEVT_OPEN_WINDOW, 1, &UIMenuWndWiFiModuleLinkCtrl);
        	Ux_PostEvent(NVTEVT_EXE_MOVIE_STRM_START,0);

#endif
		} else {
			Ux_CloseWindow(pCtrl, 0);
#if (WIFI_AP_FUNC==ENABLE)
			Ux_OpenWindow(&UIMenuWndWiFiModuleLinkCtrl, 0); //show link fail
#endif
		}
		break;
	default:
		break;
	}

	return NVTEVT_CONSUME;
}
//----------------------UIMenuWndWiFiWait_StatusGraphCtrl Event---------------------------
EVENT_BEGIN(UIMenuWndWiFiWait_StatusGraph)
EVENT_END

