#include "modelext_info.h"
#include "emb_partition_info.h"

#define BLK_UNIT(x) ((((x)%_EMBMEM_BLK_SIZE_)==0)?((x)/_EMBMEM_BLK_SIZE_):1/0) //block alignment
//#define BLK_UNIT(x) ((((x)%_EMBMEM_BLK_SIZE_)==0)?(x):1/0) //byte alignment

#if defined(_EMBMEM_SPI_NOR_)
EMB_PARTITION ind_emb_partition_info_data[EMB_PARTITION_INFO_COUNT] __attribute__((section("modelext_data.emb_partition_info"))) = {
	[0] = {EMBTYPE_LOADER,  0,  BLK_UNIT(0x00000000), BLK_UNIT(0x00010000), BLK_UNIT(0x00000000)},
	[1] = {EMBTYPE_MODELEXT, 0,  BLK_UNIT(0x00010000), BLK_UNIT(0x00010000), BLK_UNIT(0x00000000)},
	[2] = {EMBTYPE_UITRON,  0,  BLK_UNIT(0x00020000), BLK_UNIT(0x00440000), BLK_UNIT(0x00000000)},
	[3] = {EMBTYPE_UBOOT,   0,  BLK_UNIT(0x00460000), BLK_UNIT(0x00080000), BLK_UNIT(0x00000000)},
	[4] = {EMBTYPE_UENV,    0,  BLK_UNIT(0x004E0000), BLK_UNIT(0x00010000), BLK_UNIT(0x00000000)},
	[5] = {EMBTYPE_LINUX,   0,  BLK_UNIT(0x004F0000), BLK_UNIT(0x00400000), BLK_UNIT(0x00000000)},
	[6] = {EMBTYPE_DSP,     0,  BLK_UNIT(0x008F0000), BLK_UNIT(0x00500000), BLK_UNIT(0x00000000)},
	[7] = {EMBTYPE_DSP,     1,  BLK_UNIT(0x00DF0000), BLK_UNIT(0x00500000), BLK_UNIT(0x00000000)},
	[8] = {EMBTYPE_PSTORE,  0,  BLK_UNIT(0x012F0000), BLK_UNIT(0x00400000), BLK_UNIT(0x00000000)},
	[9] = {EMBTYPE_ROOTFS,  0,  BLK_UNIT(0x016F0000), BLK_UNIT(0x00910000), BLK_UNIT(0x00000000)},
};
#elif defined(_EMBMEM_EMMC_)
EMB_PARTITION ind_emb_partition_info_data[EMB_PARTITION_INFO_COUNT] __attribute__((section("modelext_data.emb_partition_info"))) = {
	[0] = {EMBTYPE_MBR,     0,  BLK_UNIT(0x00000000), BLK_UNIT(0x00000200), BLK_UNIT(0x00000000)},
	[1] = {EMBTYPE_MODELEXT,0,  BLK_UNIT(0x00040000), BLK_UNIT(0x00040000), BLK_UNIT(0x00000000)},
	[2] = {EMBTYPE_UITRON,  0,  BLK_UNIT(0x00080000), BLK_UNIT(0x00480000), BLK_UNIT(0x00000000)},
	[3] = {EMBTYPE_UBOOT,   0,  BLK_UNIT(0x00500000), BLK_UNIT(0x00200000), BLK_UNIT(0x00000000)},
	[4] = {EMBTYPE_UENV,    0,  BLK_UNIT(0x00700000), BLK_UNIT(0x00040000), BLK_UNIT(0x00000000)},
	[5] = {EMBTYPE_LINUX,   0,  BLK_UNIT(0x00740000), BLK_UNIT(0x00400000), BLK_UNIT(0x00000000)},
	[6] = {EMBTYPE_DSP,     0,  BLK_UNIT(0x00B40000), BLK_UNIT(0x01200000), BLK_UNIT(0x00000000)},
	[7] = {EMBTYPE_DSP,     1,  BLK_UNIT(0x01D40000), BLK_UNIT(0x002C0000), BLK_UNIT(0x00000000)},
	[8] = {EMBTYPE_PSTORE,  0,  BLK_UNIT(0x02000000), BLK_UNIT(0x00400000), BLK_UNIT(0x00100000)},			// Primary 1
	[9] = {EMBTYPE_ROOTFS,  0,  BLK_UNIT(0x02400000), BLK_UNIT(0x06000000), BLK_UNIT(0x00000000)},			// Primary 2
	[10] = {EMBTYPE_ROOTFS,  1,  BLK_UNIT(0x08400000), BLK_UNIT(0x0C800000), BLK_UNIT(0x00000000)},			// Primary 3 (Cache partition: ota and recovery)
	[11] = {EMBTYPE_MBR,     1,  BLK_UNIT(0x14C00000), BLK_UNIT(0x00400000), BLK_UNIT(0x00000000)},			// EBR 1
	[12] = {EMBTYPE_ROOTFS,  2,  BLK_UNIT(0x15000000), BLK_UNIT(0x500000000), BLK_UNIT(0x00000000)},		// Logical 1
	[13] = {EMBTYPE_MBR,     2,  BLK_UNIT(0x515000000), BLK_UNIT(0x00400000), BLK_UNIT(0x00000000)},		// EBR 2
	[14] = {EMBTYPE_ROOTFS,  3,  BLK_UNIT(0x515400000), BLK_UNIT(0x00000000), BLK_UNIT(0x00000000)},		// Logical 2
};
#else
EMB_PARTITION ind_emb_partition_info_data[EMB_PARTITION_INFO_COUNT] __attribute__((section("modelext_data.emb_partition_info"))) = {
	[0] = {EMBTYPE_LOADER,  0,  BLK_UNIT(0x00000000), BLK_UNIT(0x00040000), BLK_UNIT(0x00000000)},
	[1] = {EMBTYPE_MODELEXT, 0,  BLK_UNIT(0x00040000), BLK_UNIT(0x00040000), BLK_UNIT(0x00000000)},
	[2] = {EMBTYPE_UITRON,  0,  BLK_UNIT(0x00080000), BLK_UNIT(0x00880000), BLK_UNIT(0x00000000)},
	[3] = {EMBTYPE_UBOOT,   0,  BLK_UNIT(0x00900000), BLK_UNIT(0x00200000), BLK_UNIT(0x00000000)},
	[4] = {EMBTYPE_UENV,    0,  BLK_UNIT(0x00B00000), BLK_UNIT(0x00040000), BLK_UNIT(0x00000000)},
#if defined(_CPU2_LINUX_)
	[5] = {EMBTYPE_LINUX,   0,  BLK_UNIT(0x00B40000), BLK_UNIT(0x00400000), BLK_UNIT(0x00000000)},
#endif
	[6] = {EMBTYPE_DSP,     0,  BLK_UNIT(0x00F40000), BLK_UNIT(0x00800000), BLK_UNIT(0x00000000)},
	[7] = {EMBTYPE_DSP,     1,  BLK_UNIT(0x01740000), BLK_UNIT(0x00500000), BLK_UNIT(0x00000000)},
	[8] = {EMBTYPE_PSTORE,  0,  BLK_UNIT(0x01C40000), BLK_UNIT(0x00400000), BLK_UNIT(0x00100000)},
#if defined(_CPU2_LINUX_)
	[9] = {EMBTYPE_ROOTFS,  0,  BLK_UNIT(0x02040000), BLK_UNIT(0x03200000), BLK_UNIT(0x00000000)},
	[10] = {EMBTYPE_ROOTFS, 1,  BLK_UNIT(0x05240000), BLK_UNIT(0x02DC0000), BLK_UNIT(0x00000000)},
#endif
};
#endif

MODELEXT_HEADER ind_emb_partition_info_header __attribute__((section("modelext_header.emb_partition_info"))) = {
	.size = sizeof(ind_emb_partition_info_data) + sizeof(MODELEXT_HEADER),
	.type = MODELEXT_TYPE_EMB_PARTITION,
	.number = sizeof(ind_emb_partition_info_data) / sizeof(EMB_PARTITION),
	.version = EMB_PARTITION_INFO_VER,
};

